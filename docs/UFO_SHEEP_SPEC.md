# 우주선(UFO) · 양 · 잔디 · 길 동작 스펙

## 요소

- **우주선(UFO)**
- **양**
- **잔디** = 기여도가 있는 칸(초록 칸)
- **길** = 빈칸(기여도 0)

---

## 1. 진입

- 우주선이 **밖에서** 그리드 안으로 들어온다.

---

## 2. 한 마리 내리는 사이클 (2-1 ~ 2-6)

이 사이클은 **다음 양을 내릴 때까지** 반복한다.

### 2-1. 완전 정지

- 우주선이 **잔디 옆 길(빈칸)** 에 도착하면 **완전히 멈춘다** (그 위치에서 대기).

### 2-2. 불빛 켜기

- 정지한 뒤 **불빛이 생긴다**.
- 밝기는 **0에서 시작해 점점 밝아지는** 애니메이션 (램프 업).

### 2-3. 양 내리기

- 불빛이 있는 동안 **양이 내려온다**.
- 탑뷰이므로 우주선 중앙에서 내려와서, **내리는 동안 양은 우주선에 가려져 안 보인다** (또는 빛 안에서만 보임).

### 2-4. 우주선은 “양이 다 움직인 뒤”에만 이동

- 우주선은 **양이 그 위치에서의 움직임을 완전히 마친 뒤** 에만 다음 위치로 출발한다.
- **미리 움직이면 안 된다** (양이 아직 움직이는 동안 우주선이 떠나면 안 됨).

### 2-5. 양이 움직이기 시작하면 불빛 끄기

- **양이 움직임을 시작하는 시점**부터 우주선 불빛이 **점점 꺼진다** (램프 다운).

### 2-6. 불빛이 완전히 꺼진 뒤 다음 위치로

- **불빛이 다 꺼진 뒤**에만 우주선이 다음 “양을 내릴 위치(잔디 옆 길)”를 찾아 이동한다.
- 그 다음 다시 2-1부터 반복 (정지 → 불빛 → 내리기 → …).

---

## 3. 잔디를 다 먹은 뒤 (종료)

- 양이 **잔디를 다 먹으면** 양은 **멈춘다**.
- 이때는 **2번처럼 새 양을 내리지 않고**, 우주선이 **기존 양을 태우고 밖으로 나간다** (퇴장).

---

## 요약 타임라인 (한 번의 드롭)

| 순서 | 우주선                                            | 불빛                               | 양                                          |
| ---- | ------------------------------------------------- | ---------------------------------- | ------------------------------------------- |
| 1    | 밖에서 진입                                       | 꺼짐                               | -                                           |
| 2    | 잔디 옆 길에 **완전 정지**                        | 꺼짐                               | -                                           |
| 3    | 정지 유지                                         | **0 → 점점 밝아짐**                | -                                           |
| 4    | 정지 유지                                         | 밝음                               | **내려옴 (탑뷰로 우주선에 가려져 안 보임)** |
| 5    | 정지 유지                                         | 밝음                               | 땅에 내려와서 **움직임 시작**               |
| 6    | 정지 유지                                         | **움직임 시작 시점부터 점점 꺼짐** | 걸어감                                      |
| 7    | 정지 유지                                         | **완전히 꺼짐**                    | 계속 걸어감                                 |
| 8    | **양이 움직임을 완전히 마친 뒤** 다음 위치로 출발 | 꺼짐                               | 도착지에서 대기 또는 다음 행동              |
| 9    | 다음 “잔디 옆 길”로 이동 후 2-1부터 반복          | -                                  | -                                           |

**핵심 규칙**

- 우주선 이동 시점: **불빛이 다 꺼진 뒤** + **양이 그 구간 움직임을 완전히 마친 뒤**.
- 불빛 꺼지는 시점: **양이 움직이기 시작할 때**부터 서서히 꺼짐.

---

## 디버그 로그 (검증용)

다음 환경 변수로 로그를 켤 수 있다.

| 환경 변수        | 설명                                                                        |
| ---------------- | --------------------------------------------------------------------------- |
| `DEBUG_DROP=1`   | 드롭 위치·타이밍 검증 (path[0], simFirstPos, firstGrass, ufoLeave)          |
| `DEBUG_TIMING=1` | spawn / ready / moveStart, maxTotalTime                                     |
| `DEBUG_SPEC=1`   | 스펙 타임라인 (진입→불빛→양 내림→움직임 시작→불빛 끔→첫 잔디 도착→UFO 출발) |

**PowerShell 예시**

```powershell
$env:DEBUG_SPEC="1"; $env:DEBUG_DROP="1"; npm run generate
```
